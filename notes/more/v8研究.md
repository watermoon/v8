## v8 基础

### 编译
* 需要 GLIBC_2.18
    * 安装可以参考[这篇文章](https://blog.csdn.net/qq_39295044/article/details/86685789)
* gclient sync 执行失败, 缺乏配置
    ```bash
    # 在根目录创建 .gclient 文件, 内容如下
    solutions = [
        {
            "managed": False,
            "name": "src",
            "url": "https://chromium.googlesource.com/v8/v8.git",
            "custom_deps": {},
            "deps_file": ".DEPS.git",
            "safesync_url": "",
        },
    ]
    ```
* 安装完 depot_tools 后, 编译
    ```bash
    fetch v8    # 会下载很多东西
    cd v8
    gclient sync
    tools/dev/gm.py x64.release # 编译结果在 out/x64.release
    out/x64.release/d8          # 运行, d8 为 v8 的 console
    # 需改 out/x64.release 目录下的 args.gn 文件, 添加一行 v8_static_library = true 可以编译 .a
    ```

### 基本概念
* builtins
* macros
    * torque 中定义的 macro xxx, 如 PrintHelloWorld() 例子
* [字符串](string.md)
* [Torque](torque.md)
* [CAS Builtin](CSA_builtins.md)
* [Fast properties](Fast_properties_in_V8.md)

### Print
* DebugPrint
    * DebugPrintImpl
        * MaybeObject::GetHeapObjectOsSmi().Print(os)
            * heapobject: HeapObject::cast(object).map().Print(os);
        * object.ShortPrint(os)
            * os << Brief(*this)
                * maybe_object->GetHeapObjectIfStrong(&heap_object))
                    * *result = HeapObject::cast(Object(ptr_));
                * (*this) => heap_object.HeapObjectShortPrint(os);
                    * HeapStringAllocator allocator;
                    * StringStream accumulator(&allocator);
                    * String::cast(*this).StringShortPrint(&accumulator);
                    * os << accumulator.ToCString().get();


### IGNITION v.s. CodeStubAssembler v.s. TurbanFan

### TODO
- [x] 20211221 [V8 RegExp 新算法](./RegExp.md)
- [ ] Feedback Vector
- [ ] 强制开启优化
- [ ] 延迟优化
- [ ] 跨进程共享 builtin
- [ ] 属性访问

### 其它资料
* https://gist.github.com/kevincennis/0cd2138c78a07412ef21
